<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Media Search</title>
    <style>
        .search-container { margin: 20px; }
        .result { cursor: pointer; margin: 10px 0; }
        .result img { width: 100px; height: auto; }
        .player { margin-top: 20px; }
    </style>
</head>
<body>
    <div class="search-container">
        <input type="text" id="searchQuery" placeholder="Search for movies, TV shows, or anime..." />
        <button onclick="searchMedia()">Search</button>
        <div id="results"></div>
        <div class="player" id="videoPlayer"></div>
    </div>

    <script>
        const tmdbApiKey = '48c6ee3b708b5175d7e956f2104cd731'; // Replace with your TMDB API Key

        // Function to fetch data from TMDB API
        async function searchTMDB(query) {
            const movieUrl = `https://api.themoviedb.org/3/search/movie?api_key=${tmdbApiKey}&query=${query}`;
            const tvUrl = `https://api.themoviedb.org/3/search/tv?api_key=${tmdbApiKey}&query=${query}`;

            const movieResponse = await fetch(movieUrl);
            const tvResponse = await fetch(tvUrl);
            
            const movieData = await movieResponse.json();
            const tvData = await tvResponse.json();
            
            return { movieData, tvData };
        }

        // Function to fetch data from AniList API (GraphQL)
        async function searchAniList(query) {
            const queryBody = JSON.stringify({
                query: `
                    query {
                        Page(page: 1, perPage: 5) {
                            media(search: "${query}") {
                                id
                                type
                                title {
                                    romaji
                                }
                                episodes
                            }
                        }
                    }
                `
            });

            const response = await fetch('https://graphql.anilist.co', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: queryBody
            });

            const data = await response.json();
            return data.data.Page.media;
        }

        // Function to display search results
        function displayResults(data) {
            const resultsContainer = document.getElementById('results');
            resultsContainer.innerHTML = ''; // Clear previous results

            // Display movie results
            if (data.movieData.results) {
                data.movieData.results.forEach(movie => {
                    const div = document.createElement('div');
                    div.className = 'result';
                    div.innerHTML = `
                        <img src="https://image.tmdb.org/t/p/w500${movie.poster_path}" alt="${movie.title}">
                        <p>${movie.title}</p>
                    `;
                    div.onclick = () => playVideo('movie', movie.id);
                    resultsContainer.appendChild(div);
                });
            }

            // Display TV results
            if (data.tvData.results) {
                data.tvData.results.forEach(tv => {
                    const div = document.createElement('div');
                    div.className = 'result';
                    div.innerHTML = `
                        <img src="https://image.tmdb.org/t/p/w500${tv.poster_path}" alt="${tv.name}">
                        <p>${tv.name}</p>
                    `;
                    div.onclick = () => playVideo('tv', tv.id);
                    resultsContainer.appendChild(div);
                });
            }

            // Display anime results
            if (data.animeResults) {
                data.animeResults.forEach(anime => {
                    const div = document.createElement('div');
                    div.className = 'result';
                    div.innerHTML = `
                        <p>${anime.title.romaji}</p>
                    `;
                    div.onclick = () => playVideo('anime', anime.id);
                    resultsContainer.appendChild(div);
                });
            }
        }

        // Function to play the video
        function playVideo(type, id) {
            let iframeUrl = '';

            if (type === 'movie') {
                iframeUrl = `https://player.videasy.net/movie/${id}`;
            } else if (type === 'tv') {
                iframeUrl = `https://player.videasy.net/tv/${id}/1/1`;
            } else if (type === 'anime') {
                iframeUrl = `https://player.videasy.net/anime/${id}/1?dub=true`;
            }

            const videoPlayer = document.getElementById('videoPlayer');
            videoPlayer.innerHTML = `<iframe src="${iframeUrl}" width="800" height="450"></iframe>`;
        }

        // Main search function
        async function searchMedia() {
            const query = document.getElementById('searchQuery').value;
            if (!query) return;

            const tmdbResults = await searchTMDB(query);
            const animeResults = await searchAniList(query);

            displayResults({ 
                movieData: tmdbResults.movieData, 
                tvData: tmdbResults.tvData, 
                animeResults 
            });
        }
    </script>
</body>
</html>
